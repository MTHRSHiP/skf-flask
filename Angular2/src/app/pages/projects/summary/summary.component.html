<div class="container-fluid">

  <app-page-title title="Sprint result" [breadcrumbItems]="breadCrumbItems"></app-page-title>

  <div class="row">
    <div class="col-lg-12">

      <!-- Content Body -->

      <div class="card">
        <div class="card-body">
          <div class="row mb-5">
            <div class="col-sm-12">
              <div class="text-right">
                <button type="button" class="btn btn-primary btn-rounded mb-2 mr-2">
                  <i class="mdi mdi-cloud-download-outline font-size-15 mr-1"></i>Export as CSV</button>
              </div>
            </div>
            <!-- end col-->
          </div>

          <div *ngFor="let item of sprintData.items; let i = index" class="row mb-4">
            <div class="col">
              <div class="card shadow-none border">
                <div class="card-body pb-3">
                  <div class="row">
                    <div class="col-sm-10">
                      <h4 class="card-title">{{item.checklist_items_checklist_id}} {{item.checklist_items_content}}
                      </h4>
                    </div>

                    <div class="col-sm-2">
                      <div class="text-right">
                        <span *ngIf="item.status == 0"
                          class="badge badge-success font-size-11 mt-1 float-left">Resolved</span>
                        <span *ngIf="item.status == 1"
                          class="badge badge-danger font-size-11 mt-1 float-left">Open</span>
                        <button class="btn-sm btn-primary btn-md" type="button"
                          (click)="isCollapsed[i] = !isCollapsed[i]">
                          Click here
                        </button>
                      </div>
                    </div>
                  </div>
                  <div class="collapse" [ngbCollapse]="!isCollapsed[i]">
                    <ul ngbNav #nav="ngbNav" [activeId]="1" class="nav-tabs nav-tabs-custom">
                      <li [ngbNavItem]="1">
                        <a ngbNavLink>Summary</a>
                        <ng-template ngbNavContent>
                          <div class="card shadow-none border">
                            <div class="card-body">
                              <h4>{{item.kb_item_title}}</h4>
                              <p>{{item.kb_items_content}}</p>
                              <h4>Additional resources</h4>
                              <p>{{item.add_resources}}</p>
                            </div>
                          </div>
                          <div class="text-right">
                            <button class="btn btn-sm btn-danger mt-2" type="button"
                              (click)="summaryModal(deleteContent)">Delete Result</button>
                          </div>
                        </ng-template>
                      </li>
                      <li [ngbNavItem]="2" (click)="getCodeExamples(item.checklist_id)">
                        <a ngbNavLink>Test automation</a>
                        <ng-template ngbNavContent>
                          <div class="card shadow-none border">
                            <div class="card-body">
                              <span *ngFor="let item of codeData.items">
                                <h4>{{item.title}}</h4>
                                <code [highlight]="item.content" lineNumbers="True"></code> 
                              </span>
                            </div>
                          </div>
                          <div class="text-right">
                            <button class="btn btn-sm btn-danger mt-2" type="button"
                              (click)="summaryModal(deleteResult)">Delete Result</button>
                          </div>
                        </ng-template>
                      </li>
                      <li [ngbNavItem]="3">
                        <a ngbNavLink>Compliance</a>
                        <ng-template ngbNavContent>
                          <div class="card shadow-none border">
                            <div class="card-body">
                              <form>
                                <div class="form-group">
                                  <label for="evidence">Evidence</label>
                                  <textarea class="form-control" id="evidence" rows="3"></textarea>
                                </div>
                                <div class="form-group">
                                  <label class="float-left">Status</label>
                                  <select class="form-control select2-search-disable">
                                    <option value="" selected></option>
                                    <option value="1">Resolved</option>
                                    <option value="2">Not Resolved</option>
                                  </select>
                                </div>
                              </form>
                            </div>
                          </div>
                          <div class="text-right">
                            <button class="btn btn-sm btn-danger mt-2" type="button"
                              (click)="summaryModal(deleteResult)">Delete Result</button>
                          </div>
                        </ng-template>
                      </li>
                    </ul>
                    <div [ngbNavOutlet]="nav" class="compliance p-1"></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- Content Body Ends-->
    </div>
  </div>
</div>

<!-- Content Delete Modal -->
<ng-template #deleteContent let-modal>
  <div class="modal-header">
    <h5 class="modal-title mt-0">Delete Content</h5>
    <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Close click')">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <form (ngSubmit)="onSubmit()">
      <div class="form-group">
        <label for="delete">Type <b>Delete</b> to delete the content</label>
        <input type="text" class="form-control" id="delete" placeholder="Type DELETE" onfocus="this.placeholder = ''"
          onblur="this.placeholder = 'Type DELETE'">
      </div>
      <button type="submit" class="btn btn-primary">Delete</button>
    </form>
  </div>
</ng-template>

<!-- Result Delete Modal -->
<ng-template #deleteResult let-modal>
  <div class="modal-header">
    <h5 class="modal-title mt-0">Delete Result</h5>
    <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Close click')">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <form (ngSubmit)="onSubmit()">
      <div class="form-group">
        <label for="delete">Type <b>Delete</b> to delete the result</label>
        <input type="text" class="form-control" id="delete" placeholder="Type DELETE" onfocus="this.placeholder = ''"
          onblur="this.placeholder = 'Type DELETE'">
      </div>
      <button type="submit" class="btn btn-primary">Delete</button>
    </form>
  </div>
</ng-template>